<div class="container-xl px-4 mt-4">
  <!-- Account page navigation-->

  <hr class="mt-0 mb-4" />
  <div class="row">
    <div class="col-xl-4">
      <!-- Profile picture card-->
      <div class="card mb-4 mb-xl-0">
        <div class="card-header">Profile Picture</div>
        <div class="card-body text-center">
          <div class="img-account-profile-2 mb-2">
            <img [src]="getSafeImageUrl(userInfo?.imageData)" alt="" />
          </div>
          <!-- Profile picture help block-->
          <div class="small font-italic text-muted mb-4">
            JPG or PNG no larger than 5 MB
          </div>
          <input type="file" (change)="onFileSelected($event)" />
          <!-- Profile picture upload button-->
          <button class="btn btn-primary" (click)="onSubmit()" type="button">
            Upload new image
          </button>
        </div>
      </div>
    </div>
    <div class="col-xl-8">
      <!-- Account details card-->
      <div class="card mb-4">
        <div class="card-header">Account Details</div>
        <div class="card-body">
          <form [formGroup]="userForm">
            <!-- Form Group (username)-->
            <div class="mb-3">
              <label class="small mb-1" for="inputUsername"
                >Username (how your name will appear to other users on the
                site)</label
              >
              <input
                class="form-control"
                id="inputUsername"
                type="text"
                placeholder="Enter your username"
                formControlName="username"
              />
            </div>
            <!-- Form Row-->
            <div class="row gx-3 mb-3">
              <!-- Form Group (first name)-->
              <div class="col-md-6">
                <label class="small mb-1" for="inputFirstName"
                  >First name</label
                >
                <input
                  class="form-control"
                  id="inputFirstName"
                  type="text"
                  placeholder="Enter your first name"
                  formControlName="FirstName"
                />
              </div>
              <!-- Form Group (last name)-->
              <div class="col-md-6">
                <label class="small mb-1" for="inputLastName">Last name</label>
                <input
                  class="form-control"
                  id="inputLastName"
                  type="text"
                  placeholder="Enter your last name"
                  formControlName="LastName"
                />
              </div>
            </div>
            <!-- Form Row        -->
            <div class="row gx-3 mb-3">
              <!-- Form Group (organization name)-->

              <!-- Form Group (location)-->
            </div>
            <!-- Form Group (email address)-->
            <div class="mb-3">
              <label class="small mb-1" for="inputEmailAddress"
                >Email address</label
              >
              <input
                class="form-control"
                id="inputEmailAddress"
                type="email"
                placeholder="Enter your email address"
                formControlName="email"
              />
            </div>
            <!-- Form Row-->
            <div class="row gx-3 mb-3">
              <!-- Form Group (phone number)-->
              <div class="col-md-6">
                <label class="small mb-1" for="inputPhone">Phone number</label>
                <input
                  class="form-control"
                  id="inputPhone"
                  type="tel"
                  placeholder="Enter your phone number"
                  formControlName="phone_number"
                />
              </div>
              <!-- Form Group (birthday)-->
              <div class="col-md-6">
                <label class="small mb-1" for="inputBirthday">Birthday</label>
                <input
                  class="form-control"
                  type="datetime"
                  name="birthday"
                  placeholder="Enter your birthday"
                  value="06/10/1988"
                />
              </div>
            </div>
            <!-- start of password -->
            <div class="row gx-3 mb-3" *ngIf="isChangePassword">
              <!-- Form Group (phone number)-->
              <div class="col-md-4">
                <label class="small mb-1" for="inputPhone">old password</label>
                <input
                  class="form-control"
                  type="password"
                  placeholder="Enter your old password"
                  formControlName="oldPassword"
                />
              </div>
              <!-- Form Group (birthday)-->
              <div class="col-md-3">
                <label class="small mb-1" for="inputBirthday"
                  >new password</label
                >
                <input
                  class="form-control"
                  type="password"
                  placeholder="Enter your new password"
                  formControlName="newPassword"
                />
              </div>
              <div class="col-md-3">
                <label class="small mb-1" for="inputBirthday"
                  >confirm new password</label
                >
                <input
                  class="form-control"
                  type="password"
                  placeholder="Confirm your password"
                  formControlName="confirmPassword"
                />
              </div>
              <div class="col-md-1">
                <button
                  class="button-3"
                  role="button"
                  (click)="handleClosePasswordChange()"
                >
                  Close
                </button>
              </div>
            </div>

            <!-- Save changes button-->
            <button
              *ngIf="!isChangePassword"
              (click)="handleOpenPasswordChange()"
              class="button-1"
              type="button"
            >
              changes password
            </button>
            <button
              class="btn btn-primary"
              type="button"
              (click)="handleSaveChange()"
            >
              Save changes
            </button>
            <button
              class="btn btn-danger logout"
              type="button"
              (click)="Logout()"
            >
              logout
            </button>
          </form>
        </div>
      </div>

      <!-- COMMENT -->
      <div class="row" style="margin-top: 50px" *ngIf="isAllDataDone">
        <p style="margin-top: 10px; font-size: 20px; font-weight: 800">
          allcomment
        </p>
        <!-- start of search delete comment -->
        <div class="container-star">
          <div *ngFor="let i of itemsToRepeat; let index = index">
            <mat-icon
              *ngIf="index + 1 <= rating"
              (click)="handleUdateRatingWithSearch(index)"
              >star</mat-icon
            >
            <mat-icon
              *ngIf="index + 1 > rating"
              (click)="handleUdateRatingWithSearch(index)"
              >star_border</mat-icon
            >
          </div>
        </div>
        <!-- end of search delete comment -->
        <div class="comment-container">
          <div class="container-single-comment" *ngFor="let item of allComment">
            <div
              class="container-user-comment"
              style="cursor: pointer"
              [routerLink]="['/detail', item.sachid]"
            >
              <img [src]="getSafeImageUrl(item.sach.imageData)" alt="" />
            </div>
            <div class="outer-comment">
              <div class="container-star">
                <p>{{ item.sach.tensach }}</p>
                <div *ngFor="let i of itemsToRepeat; let index = index">
                  <mat-icon *ngIf="index + 1 <= item.rating">star</mat-icon>
                  <mat-icon *ngIf="index + 1 > item.rating"
                    >star_border</mat-icon
                  >
                </div>
                <p>{{ item.rating }}</p>
              </div>
              <p class="comment-content">{{ item.tieude }}</p>
            </div>
            <div class="upload-date">
              <p>Ngày đăng {{ item.ngaydang }}</p>
              <div class="buttons">
                <button
                  class="btn btn-primary"
                  (click)="startEditComment(item)"
                >
                  Chỉnh sửa
                </button>
                <button
                  class="btn btn-danger"
                  style="margin-left: 10px"
                  (click)="startDelete(item)"
                >
                  Xóa
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="container-pagination">
          <div class="container-main-pagination">
            <button class="pagination-btn" (click)="handleNextBefore('-')">
              before
            </button>
            <button class="pagination-btn">{{ pageIndex }}</button>
            <button class="pagination-btn" (click)="handleNextBefore('+')">
              next
            </button>
          </div>
        </div>
      </div>
      <!-- END OF COMMENT -->
    </div>
  </div>
</div>

<!-- HANDLE Floating windowssss -->
<div
  *ngIf="openFullscreen"
  class="full-screen-container"
  style="
    background-color: black;
    width: 100vw;
    height: 100vh;
    position: fixed;
    opacity: 0.3;
    top: 0;
    left: 0;
  "
></div>
<!-- EDIT COMMENT -->
<div *ngIf="isHandleEditCommentOpen"  class="edit-comment-container"  @fadeIn @fadeOut>
  <mat-icon
    style="
      position: absolute;
      cursor: pointer;
      right: 20px;
      top: 20px;
      font-size: 24px;
      font-weight: 900;
      box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px,
        rgb(51, 51, 51) 0px 0px 0px 3px;
      border-radius: 50%;
    "
    (click)="handleCloseAll()"
    >close</mat-icon
  >
  <p class="title">Chỉnh sửa</p>
  <img [src]="getSafeImageUrl(editComment.sach.imageData)" alt="" />
  <p>{{ editComment.tensach }}</p>
  <div class="container-star">
    <div *ngFor="let i of itemsToRepeat; let index = index">
      <mat-icon
        *ngIf="index + 1 <= editComment.rating"
        (click)="handleUdateRating(index)"
        >star</mat-icon
      >
      <mat-icon
        *ngIf="index + 1 > editComment.rating"
        (click)="handleUdateRating(index)"
        >star_border</mat-icon
      >
    </div>
  </div>
  <mat-form-field
    class="example-full-width"
    style="width: 80%; min-height: 200px; margin-top: 20px"
  >
    <mat-label>comment</mat-label>
    <textarea
      matInput
      [(ngModel)]="editComment.tieude"
      placeholder="Ex. It makes me feel..."
      style="min-height: 200px"
    ></textarea>
  </mat-form-field>
  <button
    class="btn btn-primary"
    style="margin-bottom: 20px; padding: 10px 40px"
    (click)="HandleEditComment()"
  >
    Lưu
  </button>
</div>

<div
  class="edit-comment-container"
  style="width: 20vw; min-height: none; padding: 20px"
  *ngIf="openDeleteWindow"
>
  <p class="title">Xác nhận</p>
  <div class="">
    <button
      class="btn btn-primary"
      style="margin: 20px"
      (click)="handleDeleteComment()"
    >
      Có
    </button>
    <button
      class="btn btn-danger"
      style="margin: 20px"
      (click)="closeDeleteWin()"
    >
      Hủy
    </button>
  </div>
</div>
<!-- EDIT COMMENT -->
<!--END of  HANDLE Floating windowssss -->

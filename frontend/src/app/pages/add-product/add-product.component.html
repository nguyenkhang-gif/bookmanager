<div class="container outer">
  <p class="title">Thêm Sách</p>
  <div class="container img-con">
    <img [src]="getSafeImageUrl(imageData)" alt="" />
    <input type="file" (change)="onFileSelected($event)" />
    <!-- Profile picture upload button-->
    <button class="btn btn-primary" (click)="onSubmit()" type="button">
      Upload new image
    </button>
  </div>
  <form class="example-form" [formGroup]="bookForm">
    <table class="example-full-width" cellspacing="0">
      <tr>
        <td>
          <mat-form-field class="example-full-width">
            <mat-label>Tên Sách</mat-label>
            <input matInput formControlName="tensach" />
          </mat-form-field>
        </td>
      </tr>
    </table>

    <div class="outer-cat-author-container">
      <div class="cat-container">
        <p>Thể Loại:</p>
        <button mat-button [matMenuTriggerFor]="menu" class="menu">
          {{ category?.tenchude || "Chọn" }}
        </button>
        <mat-menu #menu="matMenu" matInput>
          <button
            *ngFor="let item of catList"
            mat-menu-item
            (click)="changeCat(item)"
          >
            {{ item.tenchude }}
          </button>
        </mat-menu>
      </div>
      <div class="cat-container">
        <p>Tác giả:</p>
        <button mat-button [matMenuTriggerFor]="menu_2" class="menu">
          {{ author?.tentacgia || "Chọn" }}
        </button>
        <mat-menu #menu_2="matMenu" matInput>
          <button
            *ngFor="let item of authorList"
            mat-menu-item
            (click)="changeAuthor(item)"
          >
            {{ item.tentacgia }}
          </button>
        </mat-menu>
      </div>

      <!-- Start producer -->
      <div class="cat-container">
        <p>Nhà xuất bản:</p>
        <button mat-button [matMenuTriggerFor]="menu_3" class="menu">
          {{ producerInfo?.tennhaxuatban || "chọn" }}
        </button>
        <mat-menu #menu_3="matMenu" matInput>
          <button
            *ngFor="let item of producerInfoList"
            mat-menu-item
            (click)="changeProducer(item)"
          >
            {{ item.tennhaxuatban }}
          </button>
        </mat-menu>
      </div>
      <!-- end of producer -->
    </div>

    <table class="example-full-width" cellspacing="0">
      <!-- START OF BORROW -->
      <tr>
        <td>
          <section class="example-section">
            <label
              class="example-margin"
              style="font-weight: 700; font-size: 16px"
              >Được mượn:</label
            >
            <mat-radio-group>
              <mat-radio-button
                class="example-margin"
                value="after"
                [checked]="isBorrow"
                (click)="canBorrow()"
                >Có</mat-radio-button
              >
              <mat-radio-button
                class="example-margin"
                value="before"
                [checked]="!isBorrow"
                (click)="canNotBorrow()"
                >Không</mat-radio-button
              >
            </mat-radio-group>
          </section>
        </td>
      </tr>
      <!-- END OF BORROW -->

      <tr>
        <td>
          <mat-form-field class="example-full-width">
            <mat-label>Chiều dài</mat-label>
            <div class="input-with-unit">
              <input matInput type="number" formControlName="chieudai" />
              <span class="unit">cm</span>
            </div>
          </mat-form-field>
        </td>
        <td>
          <mat-form-field class="example-full-width">
            <mat-label>Chiều rộng</mat-label>
            <div class="input-with-unit">
              <input matInput type="number" formControlName="chieurong" />
              <span class="unit">cm</span>
            </div>
          </mat-form-field>
        </td>
        <td>
          <mat-form-field class="example-full-width">
            <mat-label>Lượt mượn</mat-label>
            <div class="input-with-unit">
              <input matInput type="number" formControlName="borrowCount" />
              <span class="unit">cm</span>
            </div>
            <button class="button-37" (click)="handleAutoFillBorrowCount()">
              tự động cập nhật
            </button>
          </mat-form-field>
        </td>
      </tr>
      <tr>
        <td>
          <mat-form-field class="example-full-width">
            <mat-label>Số lượng</mat-label>
            <div class="input-with-unit">
              <input matInput type="number" formControlName="soluong" />
              <span class="unit">quyển</span>
            </div>
          </mat-form-field>
        </td>
        <td>
          <mat-form-field class="example-full-width">
            <mat-label>Số Trang</mat-label>
            <div class="input-with-unit">
              <input matInput type="number" formControlName="sotrang" />
              <span class="unit">trang</span>
            </div>
          </mat-form-field>
        </td>
      </tr>

      <!-- row 2 -->

      <!-- end of row 2 -->
    </table>
  </form>

  <!-- =========================START OF SUBMIT======================== -->
  <button class="button-37" (click)="saveAllForm()">Thêm</button>
  <app-popup-window
    *ngIf="popupWindowOpen"
    [isDone]="!isLoading"
    (sendDataToParent)="receiveDataFromChild($event)"
  ></app-popup-window>

  <!-- =========================END OF SUBMIT======================== -->
</div>

<div class="container outer">
  <p class="title">Thêm tác giả và chủ đề</p>
  <!-- handle add tác giả  -->
  <div class="" style="display: flex; align-items: center">
    <div class="container lightouter" style="width: 300px">
      <p class="title">Tác giả</p>
      <mat-form-field
        class="example-full-width"
        style="width: 80%; margin-top: 20px"
        type="SUBMIT"
      >
        <mat-label>Tên tác giả</mat-label>
        <textarea
          matInput
          [(ngModel)]="authorToAdd"
          placeholder="Ex. It makes me feel..."
          style="min-height: 50px"
        ></textarea>
      </mat-form-field>
      <button class="btn btn-primary" (click)="handleAddAuthor()">Thêm</button>
    </div>
    <div
      class="container-item"
      style="
        width: 500px;
        display: flex;
        flex-wrap: wrap;
        height: 250px;
        margin: 50px;
        margin-top: 150px;
        overflow: scroll;
        box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px,
          rgb(51, 51, 51) 0px 0px 0px 3px;
        padding: 20px;
        border-radius: 20px;
        scroll-behavior: auto;
      "
    >
      <div
        class="item-info"
        *ngFor="let item of authorList"
        style="
          padding: 5px;
          box-shadow: rgba(6, 24, 44, 0.4) 0px 0px 0px 2px,
            rgba(6, 24, 44, 0.65) 0px 4px 6px -1px,
            rgba(255, 255, 255, 0.08) 0px 1px 0px inset;
          border-radius: 10px;
          margin: 10px;
        "
      >
        {{ item.tentacgia }}
        <button class="btn btn-primary" (click)="startEditAuthor(item)">
          edit
        </button>
        <button class="btn btn-danger" (click)="handleDeleteAuthor(item)">
          xóa
        </button>
      </div>
    </div>
  </div>
  <div class="" style="display: flex; align-items: center">
    <div class="container lightouter" style="width: 300px">
      <p class="title">Chủ đề</p>
      <mat-form-field
        class="example-full-width"
        style="width: 80%; margin-top: 20px"
        type="SUBMIT"
      >
        <mat-label>Tên chủ đề</mat-label>
        <textarea
          matInput
          [(ngModel)]="catToAdd"
          placeholder="Ex. It makes me feel..."
          style="min-height: 50px"
        ></textarea>
      </mat-form-field>
      <button class="btn btn-primary" (click)="handleAddCat()">Thêm</button>
    </div>
    <div
      class="container-item"
      style="
        width: 500px;
        display: flex;
        flex-wrap: wrap;
        height: 250px;
        margin: 50px;
        margin-top: 150px;
        overflow: scroll;
        box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px,
          rgb(51, 51, 51) 0px 0px 0px 3px;
        padding: 20px;
        border-radius: 20px;
        scroll-behavior: auto;
      "
    >
      <div
        class="item-info"
        *ngFor="let item of catList"
        style="
          padding: 5px;
          box-shadow: rgba(6, 24, 44, 0.4) 0px 0px 0px 2px,
            rgba(6, 24, 44, 0.65) 0px 4px 6px -1px,
            rgba(255, 255, 255, 0.08) 0px 1px 0px inset;
          border-radius: 10px;
          margin: 10px;
        "
      >
        {{ item.tenchude }}
        <button class="btn btn-primary" (click)="startEditCat(item)">
          edit
        </button>
        <button class="btn btn-danger" (click)="handleDeleteCat(item)">
          xóa
        </button>
      </div>
    </div>
  </div>
  <!-- ned of handle add tác giả  -->
  <!-- handle add chủ đề  -->
  <!-- Nhà Xuất Bản  -->
  <div class="" style="display: flex; align-items: center">
    <div class="container lightouter" style="width: 300px">
      <p class="title">Nhà xuất bản</p>
      <mat-form-field
        class="example-full-width"
        style="width: 80%; margin-top: 20px"
        type="SUBMIT"
      >
        <mat-label>Tên Nhà xuất bản</mat-label>
        <textarea
          matInput
          [(ngModel)]="pubToAdd"
          placeholder="Ex. It makes me feel..."
          style="min-height: 50px"
        ></textarea>
      </mat-form-field>
      <button class="btn btn-primary" (click)="handleAddPub()">Thêm</button>
    </div>
    <div
      class="container-item"
      style="
        width: 500px;
        display: flex;
        flex-wrap: wrap;
        height: 250px;
        margin: 50px;
        margin-top: 150px;
        overflow: scroll;
        box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px,
          rgb(51, 51, 51) 0px 0px 0px 3px;
        padding: 20px;
        border-radius: 20px;
        scroll-behavior: auto;
      "
    >
      <div
        class="item-info"
        *ngFor="let item of producerInfoList"
        style="
          padding: 5px;
          box-shadow: rgba(6, 24, 44, 0.4) 0px 0px 0px 2px,
            rgba(6, 24, 44, 0.65) 0px 4px 6px -1px,
            rgba(255, 255, 255, 0.08) 0px 1px 0px inset;
          border-radius: 10px;
          margin: 10px;
        "
      >
        {{ item.tennhaxuatban }}
        <button class="btn btn-primary" (click)="startEditPub(item)">
          edit
        </button>
        <button class="btn btn-danger" (click)="handleDeletePub(item)">
          xóa
        </button>
      </div>
    </div>
  </div>
  <!-- end of Nhà Xuất Bản  -->

  <!-- end of handle add chủ đề  -->
</div>

<!-- pop out window để xác nhận  -->
<!-- full screen -->
<div
  *ngIf="openFullscreen"
  class="full-screen-container"
  style="
    background-color: black;
    width: 100vw;
    height: 100vh;
    position: fixed;
    opacity: 0.3;
    top: 0;
    left: 0;
  "
></div>
<!-- end of fullscreen  -->
<div class="edit-comment-container" *ngIf="openPopupWinDow">
  <mat-icon
    style="
      position: absolute;
      cursor: pointer;
      right: 20px;
      top: 20px;
      font-size: 24px;
      font-weight: 900;
      box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px,
        rgb(51, 51, 51) 0px 0px 0px 3px;
      border-radius: 50%;
    "
    (click)="closePopupWin()"
    >close</mat-icon
  >

  <p class="title">{{ popupWindowTitle }}</p>

  <mat-form-field
    class="example-full-width"
    style="width: 80%; min-height: 200px; margin-top: 20px"
  >
    <mat-label>{{ popupWindowLabel }}</mat-label>
    <textarea
      matInput
      [(ngModel)]="editContent"
      placeholder="Ex. It makes me feel..."
      style="min-height: 200px"
    ></textarea>
  </mat-form-field>
  <button
    class="btn btn-primary"
    style="margin-bottom: 20px; padding: 10px 40px"
    (click)="saveEdit()"
  >
    Lưu
  </button>
</div>

<!-- pop out window để xác nhận  -->

<!-- popup window để confrim xóa -->

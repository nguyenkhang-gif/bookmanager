<p class="title">Tất cả sách</p>
<div class="container-search">
  <mat-form-field class="example-form-field" (keyup.enter)="onSubmit()">
    <mat-label>Search</mat-label>
    <input matInput type="text" [(ngModel)]="value" />

    <button matSuffix mat-icon-button aria-label="Clear" (click)="value = ''">
      <mat-icon>close</mat-icon>
    </button>
  </mat-form-field>
  <button mat-button [matMenuTriggerFor]="menu" *ngIf="CategoryList.length > 0">
    Thể loại
  </button>
  <mat-menu #menu="matMenu">
    <button
      *ngFor="let item of CategoryList"
      (click)="setCat(item.id)"
      mat-menu-item
    >
      {{ item.tenchude }}
    </button>
    <button (click)="setCat(null)" mat-menu-item>Không</button>
  </mat-menu>
  <!-- HTML !-->
  <button class="button-3" role="button" (click)="onSubmit()">Search</button>
</div>
<div class="container-main">
  <div class="inner-container-main" *ngIf="listbook.length > 0">
    <table class="styled-table">
      <thead>
        <tr>
          <th>STT</th>
          <th>Mã sách</th>
          <th>Ảnh</th>
          <th>Tên Sách</th>
          <th>Đồng Giá</th>
          <th>Số Lượng</th>
          <th>Được mượn</th>
          <th>Lượt mượn</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of listbook; let i = index">
          <!-- <td><img src="../../../assets/books/{{ item.hinhanh }}" alt="" /></td> -->
          <td>{{ i + 1 }}</td>
          <td>{{ convertToPaddedString(item.id) }}</td>
          <td>
            <img
              *ngIf="item.imageData"
              [src]="getSafeImageUrl(item.imageData)"
            />
          </td>
          <td>{{ item.tensach }}</td>
          <td>{{ item.dongia }}</td>
          <td>{{ item.soluong }}</td>
          <td>
            <p *ngIf="item.duocMuon == 1" class="available">Được</p>
            <p *ngIf="item.duocMuon == 0" class="un-available">Không</p>
          </td>
          <td>{{ item.borrowCount }}</td>
          <td class="button-container">
            <!-- HTML !-->
            <button
              class="button-3"
              (click)="toBookDetail(item.id)"
              role="button"
            >
              Sửa
            </button>
            <button
              class="button-3 red"
              role="button"
              (click)="startDelete(item)"
            >
              Xóa
            </button>
            <button
              class="button-3 blue"
              role="button"
              *ngIf="item.duocMuon == 1"
              (click)="addToCard(item.id)"
            >
              Thêm
            </button>
          </td>
        </tr>

        <!-- <tr class="active-row">
              <td>Melissa</td>
              <td>5150</td>
          </tr> -->
        <!-- and so on... -->
      </tbody>
    </table>
  </div>
</div>
<div class="container-pagination">
  <div class="container-main-pagination">
    <button class="pagination-btn" (click)="handleNextBefore('-')">
      before
    </button>
    <button class="pagination-btn">{{ pageIndex }}</button>
    <button class="pagination-btn" (click)="handleNextBefore('+')">next</button>
  </div>
</div>

<!-- handle popup comment delete -->
<div
  class="full-screen"
  style="
    width: 100vw;
    height: 100vh;
    background-color: black;
    position: fixed;
    opacity: 0.5;
    top: 0;
    left: 0;
  "
  *ngIf="isConfirmWindowOpen"
></div>

<div
  class="container-main"
  style="
    background-color: white;
    min-width: 50vw;
    min-height: 50vh;
    padding: 50px;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border-radius: 20px;
    box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px, rgb(51, 51, 51) 0px 0px 0px 3px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  "
  *ngIf="isConfirmWindowOpen"
>
  <mat-icon
    style="
      position: absolute;
      cursor: pointer;
      right: 20px;
      top: 20px;
      font-size: 24px;
      font-weight: 900;
      box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px,
        rgb(51, 51, 51) 0px 0px 0px 3px;
      border-radius: 50%;
    "
    
    (click)="handleCloseAll()"
    >close</mat-icon
  >
  <p style="font-size: 25px; font-weight: 900">Xóa Sách</p>
  <p style="color: brown; font-weight: 500">
    Toàn bộ các thông tin liên quan như <br />
    nhận xét và sách ở các phiếu mượn sẽ bị xóa
  </p>

  <div
    class="container-book"
    style="
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    "
    *ngIf="!spinDisk"
  >
    <img [src]="getSafeImageUrl(bookToDelete.imageData)" style="width: 50%" />
    <p class="title">{{ bookToDelete.tensach }}</p>
  </div>
  <div
    class=""
    style="
      display: flex;
      width: 50%;
      align-items: center;
      justify-content: space-around;
    "
    *ngIf="!spinDisk"
  >
    <button class="btn btn-primary" (click)="handleDelete()">Xóa</button>
    <button class="btn btn-danger">Hủy</button>
  </div>
  <mat-spinner *ngIf="spinDisk&&!deleteDone"></mat-spinner>
  <p *ngIf="deleteDone">Xóa Thành Công</p>
</div>

<!-- handle and popup comment delete -->
